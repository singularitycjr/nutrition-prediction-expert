# 百度智能云api跨域问题

在开发过程中，我们的项目需要调用[百度智能云](https://cloud.baidu.com/)的[千帆大模型](https://qianfan.cloud.baidu.com/)接口和[图像识别](https://cloud.baidu.com/product/imagerecognition)接口来支持对食物的图像识别和智能化饮食建议。但是，直接请求形如`https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/ernie-3.5-8k-0205`的接口会导致跨域问题。

![error](https://img-blog.csdnimg.cn/9c5cd58000c14783a01f5b4015dfccc4.png)

## 跨域

在Vue项目开发中，跨域问题是一个常见的挑战。由于浏览器的同源策略限制，前端项目在访问不同源的API接口时，会遇到跨域请求被阻止的问题。为了解决这个问题，开发者通常会在后端服务器配置CORS（跨源资源共享）策略，或者在前端使用代理服务器来绕过这个限制。

## 解决方案

配置代理

在`vue.config.js`中进行如下配置，利用webpack-dev-server 的代理功能来解决跨域问题。

```javascript
devServer: {
open: false,
port:8023,
hot: true,
host:'0.0.0.0',
historyApiFallback: true,
allowedHosts: 'all',
proxy: {
  '/baidu': { 
    target: 'https://aip.baidubce.com',
    changeOrigin: true,
    pathRewrite: {
      '^/baidu': ''  
    },
  },
},
}
```

1. `proxy` 字段用于配置代理规则，其中 `/baidu` 是匹配需要代理的请求路径的前缀。
2. `target` 字段指定了代理的目标地址，即实际请求应该发送到的地址。
3. `changeOrigin: true` 表示是否改变请求源，设置为 `true` 表示将请求的源更改为目标地址，这是解决跨域的关键之一。
4. `pathRewrite` 字段用于重写请求路径，这里的 `'^/baidu': ''` 表示将以 `/baidu` 开头的请求路径重写为空，也就是去掉了 `/baidu`，这样在实际发送请求时，就不会携带 `/baidu` 前缀了。

这段代码的作用是将以 `/baidu` 开头的请求转发到 `https://aip.baidubce.com`，并在转发过程中解决了跨域问题，使得前端可以正常发起跨域请求获取百度 AI 平台的数据。